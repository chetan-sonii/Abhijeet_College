{# templates/users/fees.html #}
{% extends "users/base.html" %}

{% block user_content %}
<div class="container-fluid p-0">
    <h2 class="h4 fw-bold mb-4">Financial Status</h2>

    <div class="row g-4 mb-4">
        <div class="col-md-4">
            <div class="card border-0 shadow-sm bg-primary text-white h-100">
                <div class="card-body">
                    <h6 class="card-subtitle text-white-50 mb-2">Total Fees</h6>
                    <h2 class="mb-0">${{ total_fee }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <h6 class="card-subtitle text-muted mb-2">Amount Paid</h6>
                    <h2 class="mb-0 text-success">${{ total_paid }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <h6 class="card-subtitle text-muted mb-2">
                        {% if credit > 0 %}Credit Balance{% else %}Balance Due{% endif %}
                    </h6>
                    <h2 class="mb-0 {{ 'text-success' if credit > 0 else 'text-danger' }}">
                        {% if credit > 0 %}+${{ credit }}{% else %}-${{ balance_due }}{% endif %}
                    </h2>
                </div>
            </div>
        </div>
    </div>

    <div class="card border-0 shadow-sm">
        <div class="card-header bg-white py-3">
            <h6 class="mb-0 fw-bold">Payment History</h6>
        </div>
        <div class="table-responsive">
            <table class="table align-middle mb-0">
                <thead class="bg-light">
                    <tr>
                        <th class="ps-4">Date</th>
                        <th>Transaction ID</th>
                        <th>Method</th>
                        <th class="text-end pe-4">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in history %}
                    <tr>
                        <td class="ps-4">{{ p.paid_on.strftime('%d %b, %Y') }}</td>
                        <td class="font-monospace small">{{ p.transaction_id or 'CASH' }}</td>
                        <td><span class="badge bg-light text-dark border">{{ p.payment_method or 'Manual' }}</span></td>
                        <td class="text-end pe-4 fw-bold text-success">+${{ p.amount }}</td>
                    </tr>
                    {% else %}
                    <tr><td colspan="4" class="text-center py-5 text-muted">No payments recorded.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}